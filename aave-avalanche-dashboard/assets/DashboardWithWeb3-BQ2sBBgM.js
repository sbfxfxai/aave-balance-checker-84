const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-C7E-xfNe.js","assets/web3-vendor-EwTGHx8d.js","assets/react-vendor-DCm_z5L5.js","assets/query-vendor-CtJszEQq.js","assets/ui-vendor-BOJFGSg8.js"])))=>i.map(i=>d[i]);
import{j as e}from"./ui-vendor-BOJFGSg8.js";import{C as le,L as Ve,I as Qe,D as Ke,Z as ze}from"./input-CQ5NrkaN.js";import{B as q,L as xe,T as _e}from"./button-BxxP0glo.js";import{c as re,a as je,b as Ge,d as s}from"./index-CW71wpqh.js";import{e as We,u as ce,b as Y,f as k,d as Ye,c as me,g as He,h as Ne,P as Ie,S as Je,C as Ze,j as ke,U as be,_ as ea,k as aa,l as ta,m as sa,o as ra,p as na,q as oa,r as G,w as ee,t as ae,v as ia,x as Oe,y as la,W as ca,z as da}from"./web3-vendor-EwTGHx8d.js";import{r as Q,R as Be,L as ua}from"./react-vendor-DCm_z5L5.js";import{b as Fe,Q as pa}from"./query-vendor-CtJszEQq.js";import{W as Ce}from"./IndexStatic-Cc1cIBTk.js";import"./chart-vendor-Ca7Fwevv.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=re("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=re("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=re("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=re("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=re("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),c={WAVAX:"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7",USDC:"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",USDC_E:"0xA7D7079b0FEaD91F3e65f86E8915Cb59c1a4C664",AAVE_POOL_ADDRESSES_PROVIDER:"0xa97684ead0e402dC232d5A977953DF7ECBaB3CDb",AAVE_POOL:"0x794a61358D6845594F94dc1DB02A252b5b4814aD",AAVE_POOL_DATA_PROVIDER:"0x69FA688f1Dc47d4B5d8029D5a35FB7a548310654",AAVE_UI_POOL_DATA_PROVIDER:"0x53430E0f88cC6d7b204535B3AF47538C0e0a3d48",TRADER_JOE_ROUTER:"0x60aE616a2155Ee3d9A68541Ba4544862310933d4"},ie=We,Te=[{name:"deposit",type:"function",stateMutability:"payable",inputs:[],outputs:[]},{name:"withdraw",type:"function",stateMutability:"nonpayable",inputs:[{name:"wad",type:"uint256"}],outputs:[]},{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{name:"",type:"uint256"}]},...We],va=[{name:"supply",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"onBehalfOf",type:"address"},{name:"referralCode",type:"uint16"}],outputs:[]},{name:"withdraw",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"to",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"borrow",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"interestRateMode",type:"uint256"},{name:"referralCode",type:"uint16"},{name:"onBehalfOf",type:"address"}],outputs:[]},{name:"repay",type:"function",stateMutability:"payable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"rateMode",type:"uint256"},{name:"onBehalfOf",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"getUserAccountData",type:"function",stateMutability:"view",inputs:[{name:"user",type:"address"}],outputs:[{name:"totalCollateralBase",type:"uint256"},{name:"totalDebtBase",type:"uint256"},{name:"availableBorrowsBase",type:"uint256"},{name:"currentLiquidationThreshold",type:"uint256"},{name:"ltv",type:"uint256"},{name:"healthFactor",type:"uint256"}]}],ba=[{name:"getPool",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"address"}]},{name:"getPoolAddress",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"address"}]},{name:"getAddress",type:"function",stateMutability:"view",inputs:[{name:"id",type:"uint256"}],outputs:[{name:"",type:"address"}]}],H=[{name:"getUserReserveData",type:"function",stateMutability:"view",inputs:[{name:"asset",type:"address"},{name:"user",type:"address"}],outputs:[{name:"currentATokenBalance",type:"uint256"},{name:"currentStableDebt",type:"uint256"},{name:"currentVariableDebt",type:"uint256"},{name:"principalStableDebt",type:"uint256"},{name:"scaledVariableDebt",type:"uint256"},{name:"stableBorrowRate",type:"uint256"},{name:"liquidityRate",type:"uint256"},{name:"stableRateLastUpdated",type:"uint40"},{name:"usageAsCollateralEnabled",type:"bool"}]},{name:"getReserveData",type:"function",stateMutability:"view",inputs:[{name:"asset",type:"address"}],outputs:[{name:"unbacked",type:"uint256"},{name:"accruedToTreasuryScaled",type:"uint256"},{name:"totalAToken",type:"uint256"},{name:"totalStableDebt",type:"uint256"},{name:"totalVariableDebt",type:"uint256"},{name:"liquidityRate",type:"uint256"},{name:"variableBorrowRate",type:"uint256"},{name:"stableBorrowRate",type:"uint256"},{name:"averageStableBorrowRate",type:"uint256"},{name:"liquidityIndex",type:"uint256"},{name:"variableBorrowIndex",type:"uint256"},{name:"lastUpdateTimestamp",type:"uint40"}]}];function qe(){const{address:t,isConnected:a}=ce(),{data:i,isLoading:r,error:C}=Y({address:c.AAVE_POOL_ADDRESSES_PROVIDER,abi:ba,functionName:"getPool",query:{enabled:a&&!!t}});(C||r)&&console.log("[useAavePositions] Pool address resolution:",{providerAddress:c.AAVE_POOL_ADDRESSES_PROVIDER,resolvedPoolAddress:i,fallbackPoolAddress:c.AAVE_POOL,isLoading:r,address:t,isConnected:a}),C&&console.error("[useAavePositions] Pool address resolution error:",{error:C,addressesProvider:c.AAVE_POOL_ADDRESSES_PROVIDER,address:t,isConnected:a});const{data:A,isLoading:D,error:b}=Y({address:i||c.AAVE_POOL,abi:va,functionName:"getUserAccountData",args:t?[t]:void 0,query:{enabled:a&&!!t&&(!!i||!0),refetchInterval:6e4}}),{data:x,isLoading:j,error:m}=Y({address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getReserveData",args:[c.USDC],query:{enabled:!0}});m&&console.error("[useAavePositions] USDC getReserveData error:",m);const{data:l,isLoading:n,error:d}=Y({address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getReserveData",args:[c.WAVAX],query:{enabled:!0}});d&&console.error("[useAavePositions] WAVAX getReserveData error:",d);const{data:o,isLoading:f,error:S}=Y({address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.USDC,t],query:{enabled:a&&!!t,refetchInterval:6e4}});S&&console.error("[useAavePositions] USDC getUserReserveData error:",{error:S,dataProvider:c.AAVE_POOL_DATA_PROVIDER,usdcAddress:c.USDC,address:t});const{data:w,isLoading:V,error:y,refetch:N}=Y({address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,t],query:{enabled:a&&!!t,refetchInterval:6e4}});if((y||V)&&console.log("[useAavePositions] WAVAX query state:",{isConnected:a,address:t,enabled:a&&!!t,isLoading:V,hasData:w!==void 0,hasError:!!y,error:y,dataProviderAddress:c.AAVE_POOL_DATA_PROVIDER,wavaxAddress:c.WAVAX}),!a||!t)return{healthFactor:null,totalDebt:"0",totalCollateral:"0",usdcSupply:"0",usdcBorrowed:"0",avaxSupply:"0",avaxBorrowed:"0",availableBorrow:"$0.00",usdcSupplyApy:0,avaxSupplyApy:0,usdcBorrowApy:0,avaxBorrowApy:0,avaxAvailableToBorrow:0,usdcAvailableToBorrow:0,isLoading:!1};if(r||D)return{healthFactor:null,totalDebt:"0",totalCollateral:"0",usdcSupply:"0",usdcBorrowed:"0",avaxSupply:"0",avaxBorrowed:"0",availableBorrow:"$0.00",usdcSupplyApy:0,avaxSupplyApy:0,usdcBorrowApy:0,avaxBorrowApy:0,avaxAvailableToBorrow:0,usdcAvailableToBorrow:0,isLoading:!0};if(b||!A)return console.error("[useAavePositions] getUserAccountData failed:",{error:b,rawData:A,poolAddress:i,fallbackPool:c.AAVE_POOL,address:t,isConnected:a,enabled:a&&!!t&&(!!i||!0),poolAddressLoading:r,positionsLoading:D}),{healthFactor:null,totalDebt:"0",totalCollateral:"0",usdcSupply:"0",usdcBorrowed:"0",avaxSupply:"0",avaxBorrowed:"0",availableBorrow:"$0.00",usdcSupplyApy:0,avaxSupplyApy:0,usdcBorrowApy:0,avaxBorrowApy:0,avaxAvailableToBorrow:0,usdcAvailableToBorrow:0,isLoading:!1};const[I,J,de,,,ue]=A;let W="0",he="0";if(o){const[O,L,h]=o;W=k(O||0n,6),he=k(L+h||0n,6)}let U="0",ne="0";if(y&&console.error("[useAavePositions] WAVAX reserve data ERROR:",y),w!==void 0){const O=Array.isArray(w)?w:[];O.length>=3&&(O[0],O[1],O[2])}else V||console.warn("[useAavePositions] WAVAX reserve data is undefined and not loading!");if(w)try{let O=0n,L=0n,h=0n;if(Array.isArray(w))if(w.length>=3){const v=w[0],u=w[1],g=w[2];O=typeof v=="bigint"?v:BigInt(v||0),L=typeof u=="bigint"?u:BigInt(u||0),h=typeof g=="bigint"?g:BigInt(g||0)}else console.warn("[useAavePositions] WAVAX reserve data array too short:",w.length);else if(typeof w=="object"&&w!==null&&!Array.isArray(w)){const v=w;O=BigInt(Number(v.currentATokenBalance||v[0]||0)),L=BigInt(Number(v.currentStableDebt||v[1]||0)),h=BigInt(Number(v.currentVariableDebt||v[2]||0)),console.log("[useAavePositions] Parsed WAVAX data from object format")}else console.warn("[useAavePositions] Unexpected WAVAX reserve data format:",typeof w,w);U=k(O,18);const E=L+h;ne=k(E,18)}catch(O){console.error("[useAavePositions] Error parsing WAVAX reserve data:",O,w)}else V||console.log("[useAavePositions] WAVAX reserve data is undefined (not loading)");let ye=0,Z=0,ge=0,Ae=0,Ee=0;const pe=0;if(x&&Array.isArray(x)&&x.length>=12){const[,,,,,O,L]=x;ye=Number(O||0n)/1e27*100,ge=Number(L||0n)/1e27*100}if(l&&Array.isArray(l)&&l.length>=12){const[,,,,,O,L]=l;Z=Number(O||0n)/1e27*100,Ae=Number(L||0n)/1e27*100}return de&&(Ee=Number(de)/1e8/15),{totalCollateral:I?`$${(Number(I)/1e8).toFixed(2)}`:"$0.00",totalDebt:J?`$${(Number(J)/1e8).toFixed(2)}`:"$0.00",availableBorrow:de?`$${(Number(de)/1e8).toFixed(2)}`:"$0.00",usdcSupply:W||"0.00",usdcBorrowed:he||"0.00",avaxSupply:U||"0.00",avaxBorrowed:ne||"0.00",healthFactor:ue&&ue>0n?Number(ue)/1e18:null,netApy:0,usdcSupplyApy:ye,avaxSupplyApy:Z,usdcBorrowApy:ge,avaxBorrowApy:Ae,avaxAvailableToBorrow:Ee,usdcAvailableToBorrow:pe,isLoading:r||D||f||j||n||V,refetch:N}}const P=Ye({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:11907934}}}),Le=()=>{const{address:t,isConnected:a}=ce(),{data:i,isLoading:r,refetch:C}=me({address:t,chainId:P.id,query:{enabled:a&&!!t,refetchInterval:15e3}}),{data:A,isLoading:D,refetch:b}=me({address:t,token:c.USDC,chainId:P.id,query:{enabled:a&&!!t,refetchInterval:15e3}}),{data:x}=me({address:t,token:c.USDC_E,chainId:P.id,query:{enabled:a&&!!t,refetchInterval:15e3}}),j=i?.value?BigInt(i.value):0n,m=A?.value?BigInt(A.value):0n;if(!a||!t)return{avaxBalance:"0",usdcBalance:"0",isLoading:!1,avaxValue:0n,usdcValue:0n,avaxSymbol:"AVAX",usdcSymbol:"USDC",refetchBalances:async()=>{await Promise.all([C(),b()])}};const l=x&&BigInt(x.value)>0n,n=A&&BigInt(A.value)>0n,d=l&&!n;return{avaxBalance:i?.formatted||"0",usdcBalance:A?.formatted||"0",usdcEBalance:x?.formatted||"0",isLoading:r||D,avaxSymbol:i?.symbol||"AVAX",usdcSymbol:A?.symbol||"USDC",avaxValue:j,usdcValue:m,needsMigration:d,refetchBalances:async()=>{await Promise.all([C(),b()])}}},xa=Ge("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),te=Q.forwardRef(({className:t,variant:a,...i},r)=>e.jsx("div",{ref:r,role:"alert",className:je(xa({variant:a}),t),...i}));te.displayName="Alert";const Ca=Q.forwardRef(({className:t,...a},i)=>e.jsx("h5",{ref:i,className:je("mb-1 font-medium leading-none tracking-tight",t),...a}));Ca.displayName="AlertTitle";const se=Q.forwardRef(({className:t,...a},i)=>e.jsx("div",{ref:i,className:je("text-sm [&_p]:leading-relaxed",t),...a}));se.displayName="AlertDescription";function z(t,a){switch(t){case 43114:return`https://snowtrace.io/tx/${a}`;case 43113:return`https://testnet.snowtrace.io/tx/${a}`;case 1:return`https://etherscan.io/tx/${a}`;case 5:return`https://goerli.etherscan.io/tx/${a}`;default:return`https://snowtrace.io/tx/${a}`}}Pe.type="walletConnect";function Pe(t){const a=t.isNewChainsStale??!0;let i,r;const C="eip155";let A,D,b,x,j,m;return He(l=>({id:"walletConnect",name:"WalletConnect",type:Pe.type,async setup(){const n=await this.getProvider().catch(()=>null);n&&(b||(b=this.onConnect.bind(this),n.on("connect",b)),j||(j=this.onSessionDelete.bind(this),n.on("session_delete",j)))},async connect({chainId:n,withCapabilities:d,...o}={}){try{const f=await this.getProvider();if(!f)throw new Ie;x||(x=this.onDisplayUri,f.on("display_uri",x));let S=n;if(!S){const N=await l.storage?.getItem("state")??{};l.chains.some(J=>J.id===N.chainId)?S=N.chainId:S=l.chains[0]?.id}if(!S)throw new Error("No chains found on connector.");const w=await this.isChainsStale();if(f.session&&w&&await f.disconnect(),!f.session||w){const N=l.chains.filter(I=>I.id!==S).map(I=>I.id);await f.connect({optionalChains:[S,...N],..."pairingTopic"in o?{pairingTopic:o.pairingTopic}:{}}),this.setRequestedChainsIds(l.chains.map(I=>I.id))}const V=(await f.enable()).map(N=>Ne(N));let y=await this.getChainId();return n&&y!==n&&(y=(await this.switchChain({chainId:n}).catch(I=>{if(I.code===be.code&&I.cause?.message!=="Missing or invalid. request() method: wallet_addEthereumChain")throw I;return{id:y}}))?.id??y),x&&(f.removeListener("display_uri",x),x=void 0),b&&(f.removeListener("connect",b),b=void 0),A||(A=this.onAccountsChanged.bind(this),f.on("accountsChanged",A)),D||(D=this.onChainChanged.bind(this),f.on("chainChanged",D)),m||(m=this.onDisconnect.bind(this),f.on("disconnect",m)),j||(j=this.onSessionDelete.bind(this),f.on("session_delete",j)),{accounts:d?V.map(N=>({address:N,capabilities:{}})):V,chainId:y}}catch(f){throw/(user rejected|connection request reset)/i.test(f?.message)?new be(f):f}},async disconnect(){const n=await this.getProvider();try{await n?.disconnect()}catch(d){if(!/No matching key/i.test(d.message))throw d}finally{D&&(n?.removeListener("chainChanged",D),D=void 0),m&&(n?.removeListener("disconnect",m),m=void 0),b||(b=this.onConnect.bind(this),n?.on("connect",b)),A&&(n?.removeListener("accountsChanged",A),A=void 0),j&&(n?.removeListener("session_delete",j),j=void 0),this.setRequestedChainsIds([])}},async getAccounts(){return(await this.getProvider()).accounts.map(d=>Ne(d))},async getProvider({chainId:n}={}){async function d(){const o=l.chains.map(S=>S.id);if(!o.length)return;const{EthereumProvider:f}=await ea(async()=>{const{EthereumProvider:S}=await import("./index.es-C7E-xfNe.js").then(w=>w.a2);return{EthereumProvider:S}},__vite__mapDeps([0,1,2,3,4]));return await f.init({...t,disableProviderPing:!0,optionalChains:o,projectId:t.projectId,rpcMap:Object.fromEntries(l.chains.map(S=>{const[w]=aa({chain:S,transports:l.transports});return[S.id,w]})),showQrModal:t.showQrModal??!0})}return i||(r||(r=d()),i=await r,i?.events.setMaxListeners(Number.POSITIVE_INFINITY)),n&&await this.switchChain?.({chainId:n}),i},async getChainId(){return(await this.getProvider()).chainId},async isAuthorized(){try{const[n,d]=await Promise.all([this.getAccounts(),this.getProvider()]);return n.length?await this.isChainsStale()&&d.session?(await d.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:n,chainId:d}){const o=await this.getProvider();if(!o)throw new Ie;const f=l.chains.find(S=>S.id===d);if(!f)throw new Je(new Ze);try{await Promise.all([new Promise(w=>{const V=({chainId:y})=>{y===d&&(l.emitter.off("change",V),w())};l.emitter.on("change",V)}),o.request({method:"wallet_switchEthereumChain",params:[{chainId:ke(d)}]})]);const S=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...S,d]),f}catch(S){const w=S;if(/(user rejected)/i.test(w.message))throw new be(w);try{let V;n?.blockExplorerUrls?V=n.blockExplorerUrls:V=f.blockExplorers?.default.url?[f.blockExplorers?.default.url]:[];let y;n?.rpcUrls?.length?y=n.rpcUrls:y=[...f.rpcUrls.default.http];const N={blockExplorerUrls:V,chainId:ke(d),chainName:n?.chainName??f.name,iconUrls:n?.iconUrls,nativeCurrency:n?.nativeCurrency??f.nativeCurrency,rpcUrls:y};await o.request({method:"wallet_addEthereumChain",params:[N]});const I=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...I,d]),f}catch(V){throw new be(V)}}},onAccountsChanged(n){n.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:n.map(d=>Ne(d))})},onChainChanged(n){const d=Number(n);l.emitter.emit("change",{chainId:d})},async onConnect(n){const d=Number(n.chainId),o=await this.getAccounts();l.emitter.emit("connect",{accounts:o,chainId:d})},async onDisconnect(n){this.setRequestedChainsIds([]),l.emitter.emit("disconnect");const d=await this.getProvider();A&&(d.removeListener("accountsChanged",A),A=void 0),D&&(d.removeListener("chainChanged",D),D=void 0),m&&(d.removeListener("disconnect",m),m=void 0),j&&(d.removeListener("session_delete",j),j=void 0),b||(b=this.onConnect.bind(this),d.on("connect",b))},onDisplayUri(n){l.emitter.emit("message",{type:"display_uri",data:n})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return i?i.session?.namespaces[C]?.accounts?.map(d=>Number.parseInt(d.split(":")[1]||"",10))??[]:[]},async getRequestedChainsIds(){return await l.storage?.getItem(this.requestedChainsStorageKey)??[]},async isChainsStale(){if(!a)return!1;const n=l.chains.map(f=>f.id),d=this.getNamespaceChainsIds();if(d.length&&!d.some(f=>n.includes(f)))return!1;const o=await this.getRequestedChainsIds();return!n.every(f=>o.includes(f))},async setRequestedChainsIds(n){await l.storage?.setItem(this.requestedChainsStorageKey,n)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}const Ea="https://api.avax.network/ext/bc/C/rpc";throw new Error("❌ VITE_WALLETCONNECT_PROJECT_ID is required in production! Please set it in your environment variables. Get a free project ID at https://cloud.walletconnect.com");const _=ta({chains:[P],connectors:[ra({shimDisconnect:!0}),Pe({projectId:"c0daaf12b05ec82413fc8c92c1635a76",showQrModal:!0,metadata:{name:"Aave Avalanche Dashboard",description:"Aave V3 DeFi dashboard for Avalanche C-Chain",url:typeof window<"u"?window.location.origin:"https://aave-balance-checker-84.vercel.app",icons:["https://aave-balance-checker-84.vercel.app/favicon.ico"]}})],transports:{[P.id]:sa(Ea)},ssr:!1}),Da={RESERVE_PAUSED:/reserve.*paused|paused.*reserve/i,RESERVE_INACTIVE:/reserve.*inactive|inactive.*reserve/i,RESERVE_FROZEN:/reserve.*frozen|frozen.*reserve/i,TRANSFER_FAILED:/transfer.*failed|failed.*transfer|erc20.*transfer/i,INSUFFICIENT_LIQUIDITY:/insufficient.*liquidity|liquidity.*insufficient/i,INVALID_AMOUNT:/invalid.*amount|amount.*invalid|zero.*amount/i,HEALTH_FACTOR_LOW:/health.*factor|ltv.*exceeded/i,COLLATERAL_DISABLED:/collateral.*disabled|disabled.*collateral/i};function Me(t){const a=t instanceof Error?t.message:String(t),i=String(t).toLowerCase();if(a.includes("User rejected")||a.includes("user rejected")||a.includes("User denied")||a.includes("user denied"))return{type:"user_rejected",message:"Transaction rejected in wallet",originalError:t};if(a.toLowerCase().includes("insufficient funds for gas")||a.toLowerCase().includes("insufficient funds for intrinsic transaction cost")||a.toLowerCase().includes("insufficient balance for transfer")||a.toLowerCase().includes("insufficient funds")&&a.toLowerCase().includes("transaction"))return{type:"gas_insufficient",message:"Insufficient AVAX for gas fees",originalError:t};if(a.includes("execution reverted")||i.includes("execution reverted")||a.includes("Execution reverted")||a.includes("revert")||i.includes("revert")){let r;for(const[D,b]of Object.entries(Da))if(b.test(a)||b.test(i)){r=D;break}const C=t;if(C?.data||C?.reason){const D=C.data||C.reason;typeof D=="string"?r=D:D&&typeof D=="object"&&"message"in D&&(r=String(D.message))}let A="Transaction would fail on-chain (contract revert)";return r==="RESERVE_PAUSED"?A="Aave reserve is paused. Supply is temporarily disabled.":r==="RESERVE_INACTIVE"||r==="RESERVE_FROZEN"?A="Aave reserve is inactive or frozen. Please try again later.":r==="TRANSFER_FAILED"?A="Token transfer failed. Check your USDC balance and allowance.":r==="INSUFFICIENT_LIQUIDITY"?A="Insufficient liquidity in Aave pool. Please try a smaller amount.":r==="INVALID_AMOUNT"?A="Invalid amount. Please enter a valid amount greater than zero.":r&&(A=`Contract revert: ${r}`),{type:"contract_revert",message:A,originalError:t,revertReason:r}}return a.includes("allowance")||i.includes("allowance")||a.includes("approval")||i.includes("approval")?{type:"allowance",message:"Insufficient token allowance. Please approve first.",originalError:t}:a.includes("insufficient balance")||i.includes("insufficient balance")||a.includes("balance too low")||i.includes("balance too low")?{type:"balance",message:"Insufficient token balance",originalError:t}:a.includes("network")||a.includes("Network")||a.includes("chain")||a.includes("Chain")?{type:"network",message:"Network error. Please check your connection.",originalError:t}:{type:"unknown",message:a||"Unknown error occurred",originalError:t}}function Sa(t,a){const i=Me(t);return`${a}: ${i.message}`}const Ue=[{inputs:[{internalType:"uint256",name:"amountOutMin",type:"uint256"},{internalType:"address[]",name:"path",type:"address[]"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"}],name:"swapExactAVAXForTokens",outputs:[{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address[]",name:"path",type:"address[]"}],name:"getAmountsOut",outputs:[{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],stateMutability:"view",type:"function"}],we=[{name:"supply",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"onBehalfOf",type:"address"},{name:"referralCode",type:"uint16"}],outputs:[]},{name:"withdraw",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"to",type:"address"}],outputs:[]},{name:"borrow",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"interestRateMode",type:"uint256"},{name:"referralCode",type:"uint16"},{name:"onBehalfOf",type:"address"}],outputs:[]},{name:"repay",type:"function",stateMutability:"payable",inputs:[{name:"asset",type:"address"},{name:"amount",type:"uint256"},{name:"rateMode",type:"uint256"},{name:"onBehalfOf",type:"address"}],outputs:[{name:"",type:"uint256"}]}];function Na({isOpen:t,onClose:a,action:i}){const{address:r,isConnected:C,chainId:A}=ce(),{writeContract:D,writeContractAsync:b,data:x,isPending:j}=na({mutation:{onError:h=>{console.error("Transaction error from hook:",h)}}}),m=Fe(),[l,n]=Q.useState(""),[d,o]=Q.useState(!1),[f,S]=Q.useState("approve"),[w,V]=Q.useState("full"),{data:y}=Y({address:c.AAVE_POOL_ADDRESSES_PROVIDER,abi:[{name:"getPool",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"address"}]}],functionName:"getPool",query:{enabled:C&&!!r}}),{data:N}=me({address:r,chainId:P.id,query:{enabled:C&&!!r}}),{data:I,refetch:J}=me({address:r,token:i==="repay"?c.WAVAX:void 0,chainId:P.id,query:{enabled:C&&!!r&&i==="repay",refetchInterval:15e3}}),{data:de,refetch:ue}=Y({address:i==="repay"?c.WAVAX:void 0,abi:ie,functionName:"allowance",args:r&&y&&i==="repay"?[r,y]:void 0,query:{enabled:C&&!!r&&!!y&&i==="repay",refetchInterval:2e4}}),{data:W,refetch:he}=me({address:r,token:i==="supply"?c.USDC:void 0,chainId:P.id,query:{enabled:C&&!!r&&i==="supply",refetchInterval:15e3}}),U=qe(),{data:ne,refetch:ye}=Y({address:c.USDC,abi:ie,functionName:"allowance",args:r&&y?[r,y]:void 0,query:{enabled:C&&!!r&&!!y,refetchInterval:2e4}}),{data:Z,isError:ge,isLoading:Ae,isSuccess:Ee}=oa({hash:x,query:{enabled:!!x}});Be.useEffect(()=>{Z&&x&&Z.status==="reverted"&&(console.error("Transaction reverted:",x),s.error("Transaction failed. Please check the transaction on Snowtrace."),o(!1))},[Z,x]),Be.useEffect(()=>{ge&&(console.error("Error waiting for transaction receipt"),s.error("Error confirming transaction. Please check your wallet."),o(!1))},[ge]);const pe=async()=>{if(console.log("=== ENTERING SUPPLY STEP (DIRECT) ==="),console.log("Current step state:",f),console.log("Amount entered:",l),!C||!r){s.error("Please connect your wallet");return}if(A!==P.id){s.error("Please switch to Avalanche C-Chain to perform this action",{duration:8e3});return}const h=G(l,6);console.log("Parsed amount in wei:",h.toString());let E=ne||0n;try{y&&(E=await ae(_,{address:c.USDC,abi:ie,functionName:"allowance",args:[r,y]}),console.log("Fresh allowance from contract:",E.toString()))}catch(u){console.warn("Could not read fresh allowance, using cached value:",u)}if(E<h){console.error("Insufficient allowance:",{current:E.toString(),required:h.toString()}),s.error("Insufficient allowance. Please approve first."),S("approve"),o(!1);return}console.log("=== FRESH BALANCE CHECK BEFORE SUPPLY ===");let v;try{v=await ae(_,{address:c.USDC,abi:ie,functionName:"balanceOf",args:[r]});const u=k(v,6);if(console.log("Fresh USDC balance:",v.toString(),`(${u} USDC)`),console.log("Required amount:",h.toString(),`(${l} USDC)`),v<h){const g=`Insufficient USDC balance. You have ${u} USDC, but trying to supply ${l} USDC`;console.error("❌",g),s.error(g),o(!1);return}console.log("✅ Balance check passed")}catch(u){console.warn("Could not read fresh balance, proceeding anyway:",u)}console.log("=== SUPPLY STEP DEBUG ==="),console.log("Supplying native USDC to Aave V3:",{poolAddress:y,asset:c.USDC,amountWei:h.toString(),amountFormatted:k(h,6),onBehalfOf:r,currentAllowance:E.toString(),allowanceFormatted:k(E,6)}),console.log("writeContract function type:",typeof D),console.log("isPending before supply:",j),console.log("Current hash before supply:",x),console.log("Pool address:",y),console.log("ABI length:",we.length);try{if(console.log("Calling writeContract for supply..."),!y)throw new Error("Pool address not available");const u=27,g=BigInt(Math.ceil(u*1e9));console.log("Gas parameters:",{gasPrice:`${u} gwei (${g.toString()} wei)`,note:"Avalanche C-Chain uses legacy gasPrice (not EIP-1559)"}),console.log("Calling writeContractAsync with gas parameters...");const p=await b({address:y,abi:we,functionName:"supply",args:[c.USDC,h,r,0],gas:500000n,gasPrice:g});if(console.log("writeContractAsync returned:",p),console.log("Type of returned hash:",typeof p),console.log("isPending after supply call:",j),console.log("hash after supply call:",x),!p)throw console.error("❌ Supply transaction failed - writeContract returned undefined"),console.error("This usually means:"),console.error("1. Wallet rejected the transaction"),console.error("2. User cancelled in wallet"),console.error("3. Transaction simulation failed"),new Error("Supply transaction failed - no hash returned. Check wallet for rejection or error.");console.log("✅ Supply transaction hash received:",p),s.success("Supply transaction submitted! Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,p),"_blank")}}),await new Promise(R=>setTimeout(R,3e3));try{if((await ee(_,{hash:p,timeout:12e4,pollingInterval:2e3})).status==="success")console.log("Supply confirmed! Transaction successful."),s.success(`Successfully supplied ${l} USDC to Aave V3!`),await he(),await ye(),N&&m.invalidateQueries({queryKey:["balance",{address:r,chainId:P.id}]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),n(""),o(!1),a();else throw new Error("Supply transaction failed")}catch(R){const T=R,F=T?.name==="WaitForTransactionReceiptTimeoutError"||T?.message?.includes("Timed out"),ve=T?.message?.includes("cannot query unfinalized data")||T?.details?.includes("cannot query unfinalized data");if(F||ve)console.log("Transaction submitted but confirmation timed out or data not yet finalized. Transaction is pending."),s.success("Transaction submitted! It may take a moment to confirm. Check the explorer for status.",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,p),"_blank")},duration:1e4}),await he(),await ye(),N&&m.invalidateQueries({queryKey:["balance",{address:r,chainId:P.id}]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),n(""),o(!1),a();else throw R}}catch(u){console.error("❌ SUPPLY ERROR:",u),console.error("Error type:",u?.constructor?.name),console.error("Error message:",u instanceof Error?u.message:String(u)),console.error("Error stack:",u instanceof Error?u.stack:"No stack"),console.error("Full error object:",JSON.stringify(u,Object.getOwnPropertyNames(u)));const g=Me(u);switch(console.error("Parsed error type:",g.type),g.revertReason&&console.error("Revert reason:",g.revertReason),g.type){case"user_rejected":s.error("Transaction rejected in wallet. Please try again.");break;case"gas_insufficient":s.error("Insufficient funds for gas. Please add more AVAX to your wallet.");break;case"contract_revert":console.error("Contract execution would revert. This is NOT a gas issue."),console.error("Revert reason:",g.revertReason||"Unknown"),s.error(g.message,{duration:1e4,action:{label:"View on Snowtrace",onClick:()=>{window.open("https://snowtrace.io/","_blank")}}});break;case"allowance":s.error("Insufficient allowance. Please approve first."),S("approve");break;case"balance":s.error("Insufficient USDC balance. Please check your balance and try again.");break;case"network":s.error("Network error. Please check your connection and try again.");break;default:s.error(Sa(u,"Supply failed"))}o(!1)}},Re=async()=>{if(d){console.log("handleAction already processing, ignoring duplicate call");return}if(console.log("=== handleAction called ==="),console.log("Action:",i),console.log("Step:",f),console.log("Amount:",l),console.log("isConnected:",C),console.log("address:",r),!C||!r){s.error("Please connect your wallet");return}if(A!==P.id){s.error("Please switch to Avalanche C-Chain to perform this action",{duration:8e3});return}if(!l||parseFloat(l)<=0){s.error("Please enter a valid amount");return}if(i==="supply"){if(!W||!W.value){s.error("Unable to fetch balance. Please try again.");return}const h=G(l,6),E=BigInt(W.value);if(h>E){const g=parseFloat(W.formatted);s.error(`Insufficient balance. You have ${g.toFixed(2)} USDC`);return}if(h<=0n){s.error("Amount must be greater than 0");return}if(!N||!N.value){s.error("Unable to fetch AVAX balance. Please try again.");return}const v=G("0.01",18);if(BigInt(N.value)<v){const g=parseFloat(N.formatted);s.error(`Insufficient AVAX for gas fees. You have ${g.toFixed(4)} AVAX, need at least 0.01 AVAX`);return}}o(!0);try{switch(i){case"swap":{const h=G(l,18);let E=0n;try{const p=await ae(_,{address:c.TRADER_JOE_ROUTER,abi:Ue,functionName:"getAmountsOut",args:[h,[c.WAVAX,c.USDC]]});if(Array.isArray(p)&&p.length>=2){const R=p[p.length-1],T=BigInt(Math.floor(99.5*100));E=R*T/10000n,console.log("Swap quote:",{expectedUSDC:k(R,6),minUSDC:k(E,6),slippage:"0.5%"})}}catch(p){console.warn("Failed to get swap quote, using fallback calculation:",p),E=G((parseFloat(l)*30).toString(),6)*95n/100n}if(E===0n){s.error("Unable to calculate swap quote. Please try again."),o(!1);return}const v=27,u=BigInt(Math.ceil(v*1e9));console.log("Executing swap with gas parameters:",{gasPrice:`${v} gwei`,amountIn:k(h,18)+" AVAX",minAmountOut:k(E,6)+" USDC"});const g=await b({address:c.TRADER_JOE_ROUTER,abi:Ue,functionName:"swapExactAVAXForTokens",args:[E,[c.WAVAX,c.USDC],r,BigInt(Math.floor(Date.now()/1e3)+60*20)],value:h,gas:500000n,gasPrice:u});console.log("Swap transaction hash:",g),await new Promise(p=>setTimeout(p,3e3));try{if((await ee(_,{hash:g,timeout:12e4,pollingInterval:2e3})).status==="success")s.success(`Successfully swapped ${l} AVAX → USDC!`),m.invalidateQueries({queryKey:["balance"]}),n(""),o(!1),a();else throw new Error("Swap transaction failed")}catch(p){const R=p,T=R?.name==="WaitForTransactionReceiptTimeoutError"||R?.message?.includes("Timed out"),F=R?.message?.includes("cannot query unfinalized data");if(T||F)s.success("Swap transaction submitted! Check explorer for status.",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,g),"_blank")},duration:1e4}),m.invalidateQueries({queryKey:["balance"]}),n(""),o(!1),a();else throw p}break}case"supply":if(!y){s.error("Pool address not available. Please try again."),o(!1);return}if(f==="approve"){const h=G(l,6),E=ne??0n;if(console.log("Checking allowance:",{currentAllowance:E.toString(),requiredAmount:h.toString(),poolAddress:y}),E>=h){console.log("Allowance sufficient, skipping approval"),S("supply"),o(!0),setTimeout(()=>{pe().catch(v=>{console.error("Supply step error:",v),o(!1)})},0);return}console.log("Approving native USDC for Aave V3 pool:",{token:c.USDC,spender:y,amount:h.toString()+" wei (exact amount)"});try{console.log("=== APPROVAL STEP DEBUG ==="),console.log("Attempting approval with params:",{address:c.USDC,spender:y,amount:"MAX (unlimited)"});const v=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");console.log("Using writeContractAsync from hook");const u=await b({address:c.USDC,abi:ie,functionName:"approve",args:[y,v]});if(console.log("writeContractAsync returned:",u),console.log("Type of returned hash:",typeof u),!u)throw console.error("writeContractAsync returned undefined - possible wallet rejection or error"),new Error("Approval transaction failed - no hash returned. Check if wallet rejected the transaction.");console.log("✅ Approval transaction hash:",u),console.log("Waiting for approval transaction to be mined...");let g=null,p=0;const R=20;for(;!g&&p<R;){p++,console.log(`Waiting for approval receipt... attempt ${p}/${R}`);try{if(g=await ee(_,{hash:u,timeout:3e3,pollingInterval:500}),g){console.log("✅ Approval receipt found:",g.status);break}}catch(T){console.log(`Attempt ${p} failed:`,T instanceof Error?T.message:String(T)),p<R&&(console.log("Waiting 2 seconds before retry..."),await new Promise(F=>setTimeout(F,2e3)))}}if(!g){console.log("Approval transaction not confirmed after retries, but proceeding anyway..."),s.info("Approval transaction submitted. Proceeding to supply..."),setTimeout(()=>{console.log("Proceeding to supply step after delay..."),S("supply"),setTimeout(()=>{pe()},1e3)},3e3);return}if(g.status==="success"){console.log("Approval confirmed!"),console.log("Proceeding directly to supply step..."),s.success("USDC approved! Proceeding to supply..."),S("supply"),setTimeout(()=>{console.log("Auto-executing supply step..."),pe()},1500);return}else throw new Error("Approval transaction failed")}catch(v){console.error("Approval error:",v),s.error(`Approval failed: ${v instanceof Error?v.message:"Unknown error"}`),o(!1)}}else f==="supply"&&await pe();break;case"withdraw":{if(!y){s.error("Pool address not available. Please try again."),o(!1);return}const h=G(l,6),v=BigInt(Math.ceil(27*1e9)),u=await b({address:y,abi:we,functionName:"withdraw",args:[c.USDC,h,r],gas:500000n,gasPrice:v});if(console.log("Withdraw transaction hash:",u),!u)throw new Error("Withdraw transaction failed - no hash returned. Check if wallet rejected the transaction.");s.success("Withdraw transaction submitted! Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,u),"_blank")}}),await new Promise(g=>setTimeout(g,3e3));try{if((await ee(_,{hash:u,timeout:12e4,pollingInterval:2e3})).status==="success")s.success(`Successfully withdrew ${l} USDC from Aave!`),m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),n(""),o(!1),a();else throw new Error("Withdraw transaction failed")}catch(g){const p=g,R=p?.name==="WaitForTransactionReceiptTimeoutError"||p?.message?.includes("Timed out"),T=p?.message?.includes("cannot query unfinalized data");if(R||T)s.success("Withdraw transaction submitted! Check explorer for status.",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,u),"_blank")},duration:1e4}),m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),n(""),o(!1),a();else throw g}break}case"borrow":{if(!y){s.error("Pool address not available. Please try again."),o(!1);return}const h=G(l,18),v=BigInt(Math.ceil(27*1e9)),u=await b({address:y,abi:we,functionName:"borrow",args:[c.WAVAX,h,2n,0,r],gas:500000n,gasPrice:v});if(console.log("Borrow transaction hash:",u),!u)throw new Error("Borrow transaction failed - no hash returned. Check if wallet rejected the transaction.");s.success("Borrow transaction submitted! Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,u),"_blank")}}),await new Promise(g=>setTimeout(g,3e3));try{if((await ee(_,{hash:u,timeout:12e4,pollingInterval:2e3})).status==="success"){s.success(`Successfully borrowed ${l} AVAX from Aave!`),await new Promise(p=>setTimeout(p,2e3)),"refetch"in U&&U.refetch&&await U.refetch();try{const p=await ae(_,{address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,r]});if(p&&Array.isArray(p)){const[,R,T]=p,F=R+T;console.log("Updated AVAX borrow after transaction:",k(F,18)),F>0n&&s.info(`Current AVAX debt: ${k(F,18)} AVAX`)}}catch(p){console.warn("Could not fetch updated borrow:",p)}m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),m.invalidateQueries({queryKey:["readContract"],exact:!1}),await new Promise(p=>setTimeout(p,1e3)),n(""),o(!1),a()}else throw new Error("Borrow transaction failed")}catch(g){const p=g,R=p?.name==="WaitForTransactionReceiptTimeoutError"||p?.message?.includes("Timed out"),T=p?.message?.includes("cannot query unfinalized data");if(R||T){s.success("Borrow transaction submitted! Check explorer for status.",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,u),"_blank")},duration:1e4}),await new Promise(F=>setTimeout(F,3e3));try{const F=await ae(_,{address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,r]});if(F&&Array.isArray(F)){const[,ve,De]=F,oe=ve+De;console.log("Updated AVAX borrow after transaction:",k(oe,18))}}catch(F){console.warn("Could not fetch updated borrow:",F)}"refetch"in U&&U.refetch&&await U.refetch(),m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),m.invalidateQueries({queryKey:["readContract"],exact:!1}),n(""),o(!1),a()}else throw g}break}case"repay":{if(!y){s.error("Pool address not available. Please try again."),o(!1);return}const h=I?.value?BigInt(I.value):0n,E=G(l,18);if(!N||!N.value){s.error("Unable to fetch AVAX balance for gas fees. Please try again."),o(!1);return}const v=G("0.01",18);if(BigInt(N.value)<v){s.error("Insufficient AVAX for gas fees. You need at least 0.01 AVAX for gas"),o(!1);return}if(h<E){const X=BigInt(N.value),B=E-h,K=B+v;if(X>=K){s.info(`You need ${k(B,18)} WAVAX but only have ${I?I.formatted:"0"} WAVAX. Wrapping AVAX to WAVAX...`,{duration:1e4});try{const M=await b({address:c.WAVAX,abi:Te,functionName:"deposit",value:B,gas:100000n,gasPrice:BigInt(Math.ceil(27e9))});if(!M)throw new Error("Wrap transaction failed - no hash returned");if(s.success("Wrapping AVAX to WAVAX... Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,M),"_blank")}}),await new Promise(Se=>setTimeout(Se,3e3)),(await ee(_,{hash:M,timeout:12e4,pollingInterval:2e3})).status!=="success")throw new Error("Wrap transaction failed");s.success("AVAX wrapped to WAVAX successfully!"),await J();const fe=await ae(_,{address:c.WAVAX,abi:ie,functionName:"balanceOf",args:[r]});if(fe&&BigInt(fe)<E){s.error("Still insufficient WAVAX after wrap. Please try again or wrap more AVAX."),o(!1);return}}catch(M){console.error("Wrap error:",M),s.error(`Failed to wrap AVAX: ${M instanceof Error?M.message:"Unknown error"}`),o(!1);return}}else{s.error(`Insufficient balance. You have ${I?I.formatted:"0"} WAVAX and ${N.formatted} AVAX, need ${k(E,18)} WAVAX total (including gas)`),o(!1);return}}let u=0n;try{const X=await ae(_,{address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,r]});if(X&&Array.isArray(X)){const[,B,K]=X;u=B+K}}catch(X){console.error("Could not fetch current AVAX debt:",X),s.error("Failed to fetch current debt. Please try again."),o(!1);return}if(u===0n){s.error("No AVAX debt to repay"),o(!1);return}const g=k(u,18);console.log("Current AVAX debt:",g,"Requested repay:",l,"Mode:",w);let p=E;E>u&&(p=u,s.info(`Repay amount capped to current debt: ${g} AVAX`));const R=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),T=w==="full"?R:p;if(w==="partial"){const X=p*5n/1000n;p=p+X,console.log(`Partial repay mode: using ${k(p,18)} WAVAX (requested: ${l} + 0.5% buffer)`)}if((de||0n)<p){console.log("WAVAX allowance insufficient, approving..."),s.info("Approving WAVAX for repayment...");const X=R,B=await b({address:c.WAVAX,abi:ie,functionName:"approve",args:[y,X],gas:100000n,gasPrice:BigInt(Math.ceil(27*1e9))});if(!B)throw new Error("WAVAX approval failed - no hash returned");s.success("WAVAX approval submitted! Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,B),"_blank")}}),await new Promise(K=>setTimeout(K,3e3));try{if((await ee(_,{hash:B,timeout:12e4,pollingInterval:2e3})).status!=="success")throw new Error("WAVAX approval transaction failed");s.success("WAVAX approved! Proceeding to repay..."),await ue()}catch(K){const M=K,$=M?.name==="WaitForTransactionReceiptTimeoutError"||M?.message?.includes("Timed out"),fe=M?.message?.includes("cannot query unfinalized data");if($||fe)s.info("WAVAX approval submitted. Proceeding to repay..."),await ue();else throw K}}console.log("Repay parameters:",{debt:g,repayAmount:"type(uint256).max (full repayment)",wavaxBalance:I?.formatted||"0",requestedAmount:l});const De=BigInt(Math.ceil(27*1e9)),oe=await b({address:y,abi:we,functionName:"repay",args:[c.WAVAX,T,2n,r],gas:500000n,gasPrice:De});if(console.log("Repay transaction hash:",oe),!oe)throw new Error("Repay transaction failed - no hash returned. Check if wallet rejected the transaction.");s.success("Repay transaction submitted! Waiting for confirmation...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,oe),"_blank")}}),await new Promise(X=>setTimeout(X,3e3));try{if((await ee(_,{hash:oe,timeout:12e4,pollingInterval:2e3})).status==="success"){s.success(`Successfully repaid ${l} AVAX to Aave!`),await new Promise(B=>setTimeout(B,2e3));try{const B=await ae(_,{address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,r]});if(B&&Array.isArray(B)){const[,K,M]=B,$=K+M;console.log("Updated AVAX debt after repay:",k($,18)),$>0n?s.info(`Remaining debt: ${k($,18)} AVAX`):s.success("All debt repaid! Position closed.")}}catch(B){console.warn("Could not fetch updated debt:",B)}await J(),"refetch"in U&&U.refetch&&await U.refetch(),m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),m.invalidateQueries({queryKey:["readContract"],exact:!1}),await new Promise(B=>setTimeout(B,2e3)),n(""),o(!1),a()}else throw new Error("Repay transaction failed")}catch(X){const B=X,K=B?.name==="WaitForTransactionReceiptTimeoutError"||B?.message?.includes("Timed out"),M=B?.message?.includes("cannot query unfinalized data");if(K||M){s.success("Repay transaction submitted! Check explorer for status.",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,oe),"_blank")},duration:1e4}),await new Promise($=>setTimeout($,3e3));try{const $=await ae(_,{address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:[c.WAVAX,r]});if($&&Array.isArray($)){const[,fe,Se]=$,$e=fe+Se;console.log("Updated AVAX debt after repay:",k($e,18))}}catch($){console.warn("Could not fetch updated debt:",$)}await J(),m.invalidateQueries({queryKey:["balance"]}),m.invalidateQueries({queryKey:["aavePositions"]}),m.invalidateQueries({queryKey:["userBalancesExtended"]}),m.invalidateQueries({queryKey:["readContract"],exact:!1}),n(""),o(!1),a()}else throw X}break}}}catch(h){console.error("Action failed:",h),s.error(`${i} failed: ${h instanceof Error?h.message:"Unknown error"}`),o(!1)}};if(!t)return null;const L=(()=>{switch(i){case"swap":return{title:"Swap AVAX → USDC",token:"AVAX",description:"Swap AVAX for USDC on Trader Joe DEX"};case"supply":return{title:"Supply USDC to Aave",token:"USDC",description:"Supply USDC to earn interest"};case"withdraw":return{title:"Withdraw USDC from Aave",token:"USDC",description:"Withdraw your supplied USDC"};case"borrow":return{title:"Borrow AVAX from Aave",token:"AVAX",description:"Borrow AVAX using your collateral"};case"repay":return{title:"Repay AVAX to Aave",token:"AVAX",description:"Repay your borrowed AVAX"}}})();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(le,{className:"w-full max-w-sm p-4 bg-white max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:L.title}),e.jsxs("div",{className:"space-y-2.5",children:[i==="supply"&&W&&e.jsx("div",{className:"bg-blue-50 p-2 rounded border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Available Balance"}),e.jsxs("div",{className:"text-base font-semibold text-blue-700",children:[parseFloat(W.formatted).toFixed(2)," USDC"]})]}),e.jsx(q,{type:"button",variant:"outline",size:"sm",onClick:()=>{const h=parseFloat(W.formatted);n(h.toFixed(2))},disabled:d,children:"MAX"})]})}),i==="repay"&&e.jsxs(e.Fragment,{children:[I&&e.jsx("div",{className:"bg-orange-50 p-2 rounded border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"WAVAX Balance"}),e.jsxs("div",{className:"text-base font-semibold text-orange-700",children:[parseFloat(I.formatted).toFixed(4)," WAVAX"]})]}),N&&parseFloat(N.formatted)>.01&&e.jsx(q,{type:"button",variant:"outline",size:"sm",onClick:async()=>{try{o(!0);const h=parseFloat(N.formatted)-.01,E=G(h.toFixed(4),18),v=await b({address:c.WAVAX,abi:Te,functionName:"deposit",value:E,gas:100000n,gasPrice:BigInt(Math.ceil(27*1e9))});s.success("Wrapping AVAX to WAVAX...",{action:{label:"View on Explorer",onClick:()=>window.open(z(P.id,v),"_blank")}}),await ee(_,{hash:v,timeout:12e4,pollingInterval:2e3}),s.success("AVAX wrapped to WAVAX successfully!"),await J()}catch(h){s.error(`Wrap failed: ${h instanceof Error?h.message:"Unknown error"}`)}finally{o(!1)}},disabled:d,className:"text-xs",children:"Wrap AVAX"})]})}),U.avaxBorrowed&&parseFloat(U.avaxBorrowed)>0&&e.jsxs("div",{className:"bg-red-50 p-2 rounded border border-red-200",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Current Debt"}),e.jsxs("div",{className:"text-base font-semibold text-red-700",children:[parseFloat(U.avaxBorrowed).toFixed(4)," AVAX"]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border",children:[e.jsx(Ve,{className:"text-xs flex-1",children:"Repay Mode:"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(q,{type:"button",variant:w==="full"?"default":"outline",size:"sm",onClick:()=>V("full"),disabled:d,className:"text-xs h-7",children:"Full Debt"}),e.jsx(q,{type:"button",variant:w==="partial"?"default":"outline",size:"sm",onClick:()=>V("partial"),disabled:d,className:"text-xs h-7",children:"Partial"})]})]}),w==="full"&&e.jsx(te,{className:"py-2 bg-yellow-50 border-yellow-200",children:e.jsx(se,{className:"text-xs",children:"Full debt repayment (recommended) - repays entire debt to avoid interest accrual issues"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsxs(Ve,{htmlFor:"amount",className:"text-sm",children:[L.token," Amount"]}),i==="supply"&&W&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Max: ",parseFloat(W.formatted).toFixed(2)]})]}),e.jsx(Qe,{id:"amount",type:"number",placeholder:"0.00",value:l,onChange:h=>n(h.target.value),step:"0.01",min:"0",max:i==="supply"&&W?W.formatted:void 0}),i==="supply"&&l&&W&&W.value>0n&&(()=>{try{const h=G(l,6),E=BigInt(W.value);return h>E}catch{return parseFloat(l)>parseFloat(W.formatted)}})()&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Amount exceeds available balance"})]}),e.jsx(te,{className:"py-2",children:e.jsx(se,{className:"text-xs",children:L.description})}),x&&e.jsx(te,{className:"py-2",children:e.jsxs(se,{className:"text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Transaction:"}),e.jsx("a",{href:z(P.id,x),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View on Snowtrace"})]}),e.jsxs("div",{className:"text-xs font-mono mt-0.5 break-all",children:[x.slice(0,10),"...",x.slice(-8)]}),Z&&e.jsxs("div",{className:"text-xs mt-0.5",children:["Status: ",Z.status==="success"?"✅ Success":Z.status==="reverted"?"❌ Failed":"⏳ Pending"]})]})}),i==="supply"&&U.usdcSupply&&e.jsx(te,{className:"bg-green-50 border-green-200 py-2",children:e.jsxs(se,{className:"text-xs",children:[e.jsx("div",{className:"font-semibold text-green-700",children:"Current Aave Position"}),e.jsxs("div",{className:"mt-0.5",children:["Supplied: ",parseFloat(U.usdcSupply).toFixed(2)," USDC"]}),U.usdcSupplyApy&&e.jsxs("div",{children:["APY: ",U.usdcSupplyApy.toFixed(2),"%"]})]})}),i==="supply"&&e.jsx(te,{className:`${f==="approve"?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200"} py-2`,children:e.jsxs(se,{className:"text-xs",children:[e.jsx("div",{className:"font-semibold",children:f==="approve"?"📝 Step 1: Approve USDC":"💰 Step 2: Supply to Aave V3"}),f==="supply"&&e.jsx("div",{className:"text-xs mt-0.5 text-green-700",children:"✅ Approval complete! Ready to supply."})]})}),i==="supply"&&y&&e.jsx(te,{className:"bg-gray-50 py-2",children:e.jsxs(se,{className:"text-xs",children:[e.jsxs("div",{children:["Pool: ",y.slice(0,8),"...",y.slice(-6)]}),e.jsxs("div",{children:["Token: ",c.USDC.slice(0,8),"...",c.USDC.slice(-6)," (Native USDC)"]}),ne!==void 0&&e.jsxs("div",{children:["Allowance: ",k(ne,6)," USDC"]}),e.jsxs("div",{className:"mt-0.5 text-gray-500",children:["Current Step: ",f]})]})}),e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsx(q,{variant:"outline",onClick:a,disabled:d,className:"px-3 py-1.5 h-9 text-sm",children:"Cancel"}),e.jsx(q,{onClick:Re,disabled:d||j||Ae,className:"flex-1 px-3 py-1.5 h-9 text-sm font-medium",children:d||j?"Submitting...":Ae?"Confirming...":i==="supply"?f==="approve"?"Approve USDC":"Supply to Aave":L.title})]})]})]})})}function ja(){const{address:t,isConnected:a}=ce(),{connect:i,connectors:r}=ia(),{disconnect:C}=Oe(),[A,D]=Q.useState(!1),{avaxBalance:b,usdcBalance:x,isLoading:j,avaxSymbol:m,usdcSymbol:l}=Le(),n=async()=>{D(!0);try{const o=r.find(f=>f.id==="walletConnect");o?(await i({connector:o}),s.success("Wallet connected successfully!")):s.error("WalletConnect not available")}catch(o){console.error("Connection error:",o),s.error("Failed to connect wallet")}finally{D(!1)}},d=()=>{C(),s.info("Wallet disconnected")};return a&&t?e.jsx(le,{className:"p-6 bg-card shadow-card hover:shadow-card-hover transition-all duration-300",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Ce,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Connected Wallet"}),e.jsxs("p",{className:"text-sm font-mono font-semibold text-foreground",children:[t.slice(0,6),"...",t.slice(-4)]})]})]}),e.jsxs(q,{onClick:d,variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"Disconnect"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:e.jsx(ma,{className:"h-4 w-4 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"AVAX Balance"}),e.jsx("p",{className:"text-sm font-semibold",children:j?e.jsx(xe,{className:"h-3 w-3 animate-spin"}):`${b?parseFloat(b).toFixed(4):"0.0000"} ${m}`})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(Ke,{className:"h-4 w-4 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"USDC Balance"}),e.jsx("p",{className:"text-sm font-semibold",children:j?e.jsx(xe,{className:"h-3 w-3 animate-spin"}):`$${parseFloat(x).toFixed(2)} ${l}`})]})]})]})]})}):e.jsx(le,{className:"p-6 bg-card shadow-card hover:shadow-card-hover transition-all duration-300 animate-slide-up",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-gradient-primary",children:e.jsx(Ce,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect your wallet to start using Aave on Avalanche"})]}),e.jsx(q,{onClick:n,disabled:A,className:"w-full bg-gradient-primary hover:opacity-90 transition-opacity",size:"lg",children:A?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Connect Wallet"]})})]})})}function Pa(){const{address:t,isConnected:a}=ce(),{disconnect:i}=Oe(),{avaxBalance:r,usdcBalance:C,usdcEBalance:A,needsMigration:D,isLoading:b}=Le(),x=qe(),j=Fe(),[m,l]=Q.useState(null),[n,d]=Q.useState(!1),{data:o,error:f}=Y({address:c.AAVE_POOL_DATA_PROVIDER,abi:H,functionName:"getUserReserveData",args:t?[c.WAVAX,t]:void 0,query:{enabled:a&&!!t}});Q.useEffect(()=>{if(o&&(console.log("[SimpleDashboard] DIRECT WAVAX read:",{raw:o,isArray:Array.isArray(o),length:Array.isArray(o)?o.length:"N/A"}),Array.isArray(o)&&o.length>=3)){const V=o[1],y=o[2],N=V+y;console.log("[SimpleDashboard] DIRECT calculated debt:",{stableDebt:k(V,18),variableDebt:k(y,18),totalDebt:k(N,18)})}f&&console.error("[SimpleDashboard] DIRECT WAVAX read error:",f)},[o,f]);const S=async()=>{d(!0);try{j.invalidateQueries({queryKey:["balance"]}),j.invalidateQueries({queryKey:["aavePositions"]}),j.invalidateQueries({queryKey:["userBalancesExtended"]}),j.invalidateQueries({queryKey:["readContract"],exact:!1}),"refetch"in x&&x.refetch&&await x.refetch(),s.success("Positions refreshed!")}catch(V){s.error("Failed to refresh positions"),console.error("Refresh error:",V)}finally{d(!1)}},w=()=>{i(),s.info("Wallet disconnected")};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(le,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"Connected Wallet"]}),e.jsxs(q,{variant:"outline",onClick:w,children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Disconnect"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsxs("p",{className:"font-mono",children:[t?.slice(0,6),"...",t?.slice(-4)]})]})]}),e.jsxs(le,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Your Balances"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-blue-500/5 border border-blue-500/20",children:[e.jsx("p",{className:"font-medium text-blue-500",children:"AVAX"}),e.jsx("p",{className:"text-2xl font-bold",children:b?"...":r?parseFloat(r).toFixed(4):"0.0000"}),e.jsx("p",{className:"text-sm text-gray-600",children:"In Wallet"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-green-500/5 border border-green-500/20",children:[e.jsx("p",{className:"font-medium text-green-500",children:"USDC (Native)"}),e.jsx("p",{className:"text-2xl font-bold",children:b?"...":parseFloat(C).toFixed(2)}),e.jsx("p",{className:"text-sm text-gray-600",children:"In Wallet"}),D&&parseFloat(A)>0&&e.jsxs("p",{className:"text-xs text-orange-500 mt-1",children:["⚠️ You have ",parseFloat(A).toFixed(2)," USDC.e - swap to native USDC for Aave V3"]})]})]})]}),e.jsxs(le,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Your Aave Positions"}),e.jsxs(q,{variant:"outline",size:"sm",onClick:S,disabled:n,className:"flex items-center gap-2",children:[e.jsx(ga,{className:`h-4 w-4 ${n?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-green-500/5 border border-green-500/20",children:[e.jsx("p",{className:"font-medium text-green-500",children:"USDC Supplied"}),e.jsx("p",{className:"text-2xl font-bold",children:parseFloat(x.usdcSupply).toFixed(2)}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Earn ",(x.usdcSupplyApy||3.14).toFixed(2),"% APY"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-red-500/5 border border-red-500/20",children:[e.jsx("p",{className:"font-medium text-red-500",children:"AVAX Borrowed"}),e.jsx("p",{className:"text-2xl font-bold",children:parseFloat(x.avaxBorrowed||"0").toFixed(4)}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Pay ",(x.avaxBorrowApy||3.55).toFixed(2),"% APY"]}),!1]})]})]}),e.jsxs(le,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(q,{onClick:()=>l("swap"),className:"flex items-center gap-2 h-12",children:[e.jsx(fa,{className:"h-4 w-4"}),"Swap AVAX → USDC"]}),e.jsxs(q,{onClick:()=>l("supply"),className:"flex items-center gap-2 h-12",variant:"outline",children:[e.jsx(ya,{className:"h-4 w-4"}),"Supply USDC to Aave"]}),e.jsxs(q,{onClick:()=>l("withdraw"),className:"flex items-center gap-2 h-12",variant:"outline",children:[e.jsx(ha,{className:"h-4 w-4"}),"Withdraw USDC"]}),e.jsxs(q,{onClick:()=>l("borrow"),className:"flex items-center gap-2 h-12",variant:"outline",children:[e.jsx(Aa,{className:"h-4 w-4"}),"Borrow AVAX"]}),e.jsxs(q,{onClick:()=>l("repay"),className:"flex items-center gap-2 h-12",variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4"}),"Repay AVAX"]})]})]}),m&&e.jsx(Na,{isOpen:!!m,onClose:()=>l(null),action:m})]}):e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx(ja,{})})}function Ra(){const{chainId:t,isConnected:a}=ce(),{switchChain:i,isPending:r}=la(),C=Q.useCallback(()=>{try{i({chainId:P.id})}catch(A){throw console.error("Failed to switch chain:",A),s.error("Failed to switch network. Please switch manually in your wallet."),A}},[i]);return Q.useEffect(()=>{if(a&&t&&t!==P.id){const A=t===43113?"Avalanche Fuji Testnet":`Chain ${t}`;s.error(`Please switch to Avalanche C-Chain. Currently connected to ${A}.`,{duration:8e3,action:{label:"Switch Network",onClick:C}})}},[t,a,C]),{isCorrectChain:t===P.id,isSwitching:r,chainId:t,switchToAvalanche:C}}function Va(){const{isCorrectChain:t,isSwitching:a,chainId:i,switchToAvalanche:r}=Ra();if(t||!i)return null;const C=()=>{try{r()}catch{}};return e.jsxs(te,{className:"mb-4 border-orange-500 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(wa,{className:"h-4 w-4 text-orange-600"}),e.jsxs(se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:["Wrong network detected. Please switch to ",e.jsx("strong",{children:"Avalanche C-Chain"})," to use this app."]}),e.jsx(q,{onClick:C,disabled:a,size:"sm",variant:"outline",className:"ml-4 border-orange-600 text-orange-700 hover:bg-orange-100",children:a?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"mr-2 h-3 w-3 animate-spin"}),"Switching..."]}):"Switch Network"})]})]})}const Ia=new da({defaultOptions:{queries:{staleTime:3e4,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!0,refetchOnReconnect:!1}}}),ka=()=>e.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse bg-muted h-10 w-32 rounded-md"})});function Ba({children:t}){return e.jsx(ca,{config:_,children:e.jsx(pa,{client:Ia,children:e.jsx(Q.Suspense,{fallback:e.jsx(ka,{}),children:t})})})}function Ta(){const{isConnected:t}=ce();return e.jsxs("div",{className:"min-h-screen bg-gradient-subtle",children:[e.jsx("header",{className:"border-b border-border/50 backdrop-blur-sm bg-background/80 sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-primary",children:e.jsx(_e,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Aave Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avalanche C-Chain"})]})]}),e.jsx(ua,{to:"/stack",children:e.jsxs(q,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Stack App"]})})]})})}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx(Va,{}),e.jsx(Pa,{})]})}),e.jsx("footer",{className:"border-t border-border/50 mt-16",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Powered by Aave V3 • Avalanche C-Chain • Trader Joe"})})})]})}function $a(){return e.jsx(Ba,{children:e.jsx(Ta,{})})}export{$a as default};
